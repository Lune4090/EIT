# EITアルゴリズム

## EITアルゴリズムにおけるFEM順問題

上の話を単純化すると、EITの順問題とは

$$
V = F(\sigma, I)
\\ \quad
\\ V: 電極電位
\\ I: 電極電流
\\ \sigma: ノード導電率
$$

に帰着される。$F$ が具体的に何であるかは上の式から、ポテンシャルエネルギーの偏微分=0とノイマン境界条件より、電位について成り立つ連立方程式 $M U = (\vec{0} + I)$ を $U = M^{-1} (\vec{0} + I)$ に変形すればいいと思う。

一般には $M$ はノード数分の巨大な疎行列なので、解くのはBLASとかで工夫しないと解くのは大変

## EITアルゴリズムにおけるFEM逆問題

再構成アルゴリズムは逆問題であり、差分値再構成と絶対値再構成に分かれる。

### 差分値再構成

電極電位 $V_m$ について

$$
\Delta V_m = F(\sigma_{ref} + \Delta \sigma, I_m) - F(\sigma_{ref}, I_m)
$$

が成り立つことを利用し、右辺をJacobian $J = \frac{\partial V_l}{\partial \sigma_k}$ で $J(\sigma_{ref}, I_m) \Delta \sigma$ と線形近似して、

$$
RMS = \Sigma_{m=1}^M |\Delta V_m - J \Delta \sigma|^2 + p(\Delta \sigma)
\\ \quad
\\ L: (電位を計測する)電極個数
\\ M: (電流を印加する)電極個数
\\ p = \lambda |\Delta \sigma|^2: Tikhonovの正則化項
$$

を最小化する最適解 $\sigma$ を求める。これは線型方程式なので解を直接求める方法がある (Lionheart, 2009)

差分値再構成は、

1. 境界面形状や位置・接触抵抗のモデル誤差がキャンセルされる
2. 線形近似により一発で解が求まるので再構成に反復計算を要しない

などの点で優れるが、

1. 線形近似を用いているため差分が大きいと線形近似が破綻する
2. 仮定とする基準の導電率分布の誤差に影響される

という欠点もある。

### 絶対値再構成

$$
RMS = \Sigma_{m=1}^M |\Delta V_m - F(\sigma, I_m)|^2 + p(\sigma)
$$

を最小化する最適解 $\sigma$ を求める。これは反復計算でなんとかするしか無い。

絶対値再構成の弱点は差分値再構成の裏返しである。

## EITアルゴリズム中の諸問題

### 解像度限界を決定するファクター

[参考(かなり古いが...)](https://iopscience.iop.org/article/10.1088/0143-0815/9/4A/007/pdf)

[上記に言及している資料](https://ieeexplore.ieee.org/abstract/document/962276)

円筒形の物体中心部に異なる電気伝導率を持つ半径 $r$ の物体(phantom)が存在している時、交流電流を用いたEITによってその物体を検知できる理論的限界

1. 全電極に電流を印加する場合 (ACT)

$$
r \geq r_b = \simeq (\frac{f \pi h \sigma_o \epsilon_v}{5L})^{I/2}r_0
$$

$r_b$: 検出可能な最小の物体半径
$r_0$: 円筒半径
$\sigma_o$: 円筒の伝導率
$\epsilon_v$: センサの感度限界 $\Delta V$
$f$: 電極がカバーする表面積の割合 $(f \simeq 1)$
$h$: 円筒高さ
$w$: 電極間距離 $(= \frac{f r_0 2 \pi}{L})$

2. 隣り合う電極に電流を印加する場合

$$
r \geq r_a = [\frac{4\sin(f\pi/L)\sin(\pi/L)}{\pi}]^{-{1/2}}r_b
$$

3. 反対側の電極に電流を印加する場合

$$
r \geq r_a = [\frac{4\sin(f\pi/L)}{\pi}]^{-{1/2}}r_b
$$

つまり、ここからわかるのは、**1以外のパターンでは、電極数を増やしても精度が増加するとは限らないが、逆に言うと、1の場合では電極を増やすことが解像度向上の有効な戦略である**ということ